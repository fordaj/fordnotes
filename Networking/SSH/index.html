<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>fordnotes: SSH</title>

    <link rel="stylesheet" href="/style.css">
    <script src="/script.js"></script>
    <!-- BEGIN mermaid.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/8.13.4/mermaid.min.js"></script>  
    <script>mermaid.initialize({startOnLoad:true, securityLevel:'loose'});</script>
    <!-- END mermaid.js -->
    <!-- BEGIN highlight.js -->
    <link rel="stylesheet" href="/highlight/styles/default.min.css">
    <script src="/highlight/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
    <!-- END highlight.js -->
    <script>
    </script>
</head>
<body>
    <div class="navbar top">
        <a href="../../index.html">Home</a>
        <div class="dropdown">
          <button class="dropbtn">Coding 
            <i class="fa fa-caret-down"></i>
          </button>
          <div class="dropdown-content">
            <a href="../../Coding/Python/index.html">Python</a>
          </div>
        </div> 
        <div class="dropdown">
          <button class="dropbtn">Computers 
            <i class="fa fa-caret-down"></i>
          </button>
          <div class="dropdown-content">
            <a href="../../Computers/Virtual_Machines/index.html">Virtual Machines</a>
          </div>
        </div> 
        <div class="dropdown">
          <button class="dropbtn">Networking 
            <i class="fa fa-caret-down"></i>
          </button>
          <div class="dropdown-content">
            <a href="../../Networking/SSH/index.html">SSH</a>
          </div>
        </div> 
    </div>
    <section class="container">
        <section class="left">
            <div class="mermaid">  
            flowchart TB  
                %% Class Definitions
                classDef NotStarted fill:#f76a6a,stroke:#000
                classDef InProgress fill:#ffa500,stroke:#000
                classDef Completed fill:#229901,stroke:#000
    
                %% Class Assignments
                A[Installation]:::NotStarted
                B:::NotStarted
                C[Add Key to ssh-agent]:::InProgress
                D[Add Key to Keychain Manager]:::InProgress
                E[Setup Host for Incoming SSH Connections]:::InProgress
                F:::InProgress
                G[Generate Keypair]:::Completed
                H[Bitbucket Usage]:::NotStarted
                I[Copy Public Key from Another PC]:::InProgress
                
                %% Flowchart
                subgraph B[Configuration]
                    C & D & E
                end
                A --> B
                subgraph F[Usage]
                    G & H & I
                end
                B --> F
                
                %% Click Events
                click C call toggleDisplay("add_key_to_ssh_agent")
                click D call toggleDisplay("add_key_to_keychain_manager")
                click E call toggleDisplay("setup_host_for_incoming_ssh_connections")
                click G call toggleDisplay("generate_keypair")
                click I call toggleDisplay("copy_public_key_from_another_pc")
    
            </div>  
        </section>
        <section class="right">
            <section class="introduction">
                <h1>Key Generation</h1>
                <h2>Definitions</h2>
                <div>
                    <ul>
                        <li><span class="term">Client</span>: The PC you're typing on</li>
                        <li><span class="term">Host</span>: The PC you're connecting to</li>
                        <li>Most SSH keys should have a password for security reasons.</li>
                    </ul>
                </div>
            </section>
    
            <section class="entry" id="add_key_to_ssh_agent">
                <h2>Add Key to <code>ssh-agent</code></h2>
                <div class="versions">
                    <button class="version in-progress">Windows 10</button>
                    <button class="version in-progress">Windows 11</button>
                </div>
                <div class="command windows-10">
                    <ol>
                        <li>Open Git Bash</li>
                        <li>Start the git ssh-agent</li>
                        <pre><button onclick="copy(nextSibling)">Copy</button><code class="lanaguage-bash">eval $(ssh-agent)</code><p class="language">bash</p></pre>
                        <li>Add key to ssh credentials</li>
                        <pre><button onclick="copy(nextSibling)">Copy</button><code class="language-bash">ssh-add key_name</code><p class="language">bash</p></pre>
                        <li>To force git on Windows to use the OpenSSH command, configure it with a git command in PowerShell as admin:</li>
                        <pre><button onclick="copy(nextSibling)">Copy</button><code class="language-powershell">git config --global core.sshCommand C:/Windows/System32/OpenSSH/ssh.exe</code><p class="language">bash</p></pre>
                    </ol>
                </div>
            </section>
    
            <section class="entry macos" id="add_key_to_keychain_manager">
                <h2>Add Key to Keychain Manager</h2>
                <div class="versions">
                    <button class="version in-progress">MacOS Monterey</button>
                </div>
                <p class="content">Add the following to the bottom of your <span class="path">~/.ssh/config</span>~/.ssh/config file:</p>
                <pre><button onclick="copy(nextSibling)">Copy</button><code class="language-yaml" id="ssh-start-git-agent">Host *
        AddKeysToAgent yes
        UseKeychain yes</code><p class="language">YAML</p></pre>
            </section>
    
            <section class="entry windows-10" id="setup_host_for_incoming_ssh_connections">
                <h2>Incoming SSH Connections</h2>
                <div class="versions">
                    <button class="version in-progress">Windows 10</button>
                </div>
                <p class="content">
                    <ol>
                        <li>Run <span class="software">PowerShell</span> as administrator</li>
                        <li>Install <span class="software">OpenSSH.server</span></li>
                        <pre><button onclick="copy(nextSibling)">Copy</button><code class="language-powershell">Add-WindowsCapability -Online -Name OpenSSH.Server~~~~0.0.1.0</code><p class="language">PowerShell</p></pre>
                        <li>Start the <span class="software">SSHD</span> service (and verify it is running)</li>
                        <pre><button onclick="copy(nextSibling)">Copy</button><code class="language-powershell">Start-Service sshd</code><p class="language">PowerShell</p></pre>
                        <pre><button onclick="copy(nextSibling)">Copy</button><code class="language-powershell">Get-Service sshd</code><p class="language">PowerShell</p></pre>
                        <li>Set the <span class="software">SSHD</span> service to run automatically on startup</li>
                        <pre><button onclick="copy(nextSibling)">Copy</button><code class="language-powershell">Set-Service ssh-agent -StartupType Automatic</code><p class="language">PowerShell</p></pre>
                        <li>Add a key to the <span class="software">SSHD</span> service</li>
                        <pre><button onclick="copy(nextSibling)">Copy</button><code class="language-powershell">ssh-add C:\Users\USERNAME\ssh\id_rsa</code><p class="language">PowerShell, Bash</p></pre>
                    </ol>
                </p>
            </section>
    
            <section class="entry" id="generate_keypair">
                <h2>Generate Keypair</h2>
                <div class="versions">
                    <button class="version in-progress">Windows 10</button>
                    <button class="version in-progress">Windows 11</button>
                    <button class="version completed">MacOS Monterey</button>
                    <button class="version completed">Linux</button>
                    <button class="version completed">Raspbian</button>
                </div>
                <ul>
                    <li>The client should hold both keys</li>
                    <li>The public key is the only key allowed to be shared with others</li>
                </ul>
                <p>
                    Key Type: <input type="text" placeholder="RSA" class="key-type" onchange="renderInput('key-type')"><br>
                    Number of Bits: <input type="text" placeholder="4096" class="key-bits" onchange="renderInput('key-bits')"><br>
                    Comment: <input type="text" placeholder="myEmail@domain.com" class="key-comment" onchange="renderInput('key-comment')"><br>
                    Location: <input type="text" placeholder="~/.ssh/key_name" class="key-location" onchange="renderInput('key-location')"><br>
                    Password: <input type="text" placeholder="password" class="password" onchange="renderInput('password')">
                </p>
                <div class="command">
                    <pre><button onclick="copy(nextSibling)">Copy</button><code class="nohighlight">ssh-keygen -t <span class="key-type">RSA</span> -b <span class="key-bits">4096</span> -C "<span class="key-comment">myEmail@domain.com</span>" -f <span class="key-location">~/.ssh/key_name</span> -N <span class="password">password</span></code><p class="language">bash</p></pre> 
        
                </div>
            </section>
    
            <section class="entry windows-10 windows-11 macos-monterey linux raspbian" id="copy_public_key_from_another_pc">
                <h2>Copy Public Key from Another PC</h2>
                <div class="versions">
                    <button class="version in-progress">Windows 10</button>
                    <button class="version in-progress">Windows 11</button>
                    <button class="version in-progress">MacOS Monterey</button>
                    <button class="version in-progress">Linux</button>
                    <button class="version in-progress">Raspbian</button>
                </div>
                <p class="content">
                    <ol>
                        <li>Run <span class="command">ssh-copy-id</span> with the following format:</li>
                        Location: <input class="copy_location" placeholder="~/.ssh/key_name" onchange="renderInput('copy_location')"><br>
                        Destination: <input class="copy_destination" placeholder="user@host" onchange="renderInput('copy_destination')">
                        <pre><button onclick="copy(nextSibling)">Copy</button><code class="nohighlight">ssh-copy-id -i <span class="copy_location">~/.ssh/key_name</span> <span class="copy_destination">user@host</span></code><p class="language">bash</p></pre>
                    </ol>
                </p>
            </section>
        </section>
    </section>
</body>
</html>